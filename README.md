# Attempts to differentiate `eigmin` in Julia

Generated by `run.jl`; uses OS-dependent paths that likely need to be updated.
## Method @adjoint (real rep of Hermitian).jl

Code:

```julia
using Zygote, LinearAlgebra
using KrylovKit: eigsolve

# helper for `herm`
function f(x, y, i, j)
    if i == j
        return x + 0im
    elseif i > j
        return x + im * y
    elseif i < j
        return x - im * y
    end
end

# Create a complex `d` by `d` Hermitian matrix from a `d^2`-dimensional real vector `v`
function herm(v::AbstractVector)
    d = isqrt(length(v))
    @assert d^2 == length(v)
    m = reshape(v, d, d)
    m = [ f(m[i,j], m[j,i], i, j) for i = 1:d, j = 1:d ]
    return m
end

# Recover the vector representation
invherm(A::AbstractMatrix) = vec(real(A))

# Find the minimal eigenvalue using KrylovKit (from a vector representation)
function eigmin_vec(v::AbstractVector)
    A = herm(v)
    eigsolve(A, 1, :SR)[1][1] |> real
end

# Give an adjoint for `Zygote`, which technically only works in the non-degenerate case
Zygote.@adjoint function eigmin_vec(v::AbstractVector)
    A = herm(v)
    eigs = eigsolve(A, 1, :SR)
    eval = eigs[1][1]
    evec = eigs[2][1]
    adj = (evec * evec') |> invherm
    return eval |> real, c->(c * adj,)
end

A = rand(4, 4); A = A + A';
v = invherm(A)

@show eigmin(A)
@show eigmin_vec(v)
@show Zygote.gradient(eigmin_vec, v)
```

Results:

### Julia 1.1, with Zygote master

```julia
eigmin(A) = -0.8078789788911267
eigmin_vec(v) = -1.9581067015671945
Zygote.gradient(eigmin_vec, v) = ([0.47679, 0.00475815, -0.136318, -0.327907, 0.00475815, 0.0425654, 0.0943152, -0.00933051, -0.136318, 0.0943152, 0.254268, 0.0801185, -0.327907, -0.00933051, 0.0801185, 0.226377],)
```


### Julia 1.2, with Zygote master

```julia
eigmin(A) = -1.1372203280107402
eigmin_vec(v) = -2.1018366344920256
Zygote.gradient(eigmin_vec, v) = ([0.39837560964363916, 0.01532176403897223, 0.018843111312866895, -0.37500833839094727, 0.01532176403897223, 0.008750292278393496, 0.04017521061891152, 0.005423964445178373, 0.018843111312866895, 0.04017521061891152, 0.19159583251396275, 0.07820303855098244, -0.37500833839094727, 0.005423964445178373, 0.07820303855098244, 0.4012782655640047],)
```


### Julia 1.3, with Zygote master

```julia
eigmin(A) = -1.2240591297318597
eigmin_vec(v) = -2.546352747781013
Zygote.gradient(eigmin_vec, v) = ([0.1777968086365543, 0.14862318758203363, -0.22990595665998476, -0.1565564336311766, 0.14862318758203363, 0.36913735812029724, -0.12796403149620966, -0.1471736516772433, -0.22990595665998476, -0.12796403149620966, 0.31412666981323356, 0.19816472686121625, -0.1565564336311766, -0.1471736516772433, 0.19816472686121625, 0.13893916342991502],)
```


### Julia 1.1, with Zygote release

```julia
eigmin(A) = -1.5562998320035897
eigmin_vec(v) = -2.575436759655515
Zygote.gradient(eigmin_vec, v) = ([0.18366, 0.221277, -0.250579, -0.0547375, 0.221277, 0.295235, -0.233653, -0.063296, -0.250579, -0.233653, 0.504546, 0.0810042, -0.0547375, -0.063296, 0.0810042, 0.0165595],)
```


### Julia 1.2, with Zygote release

```julia
eigmin(A) = -0.5682950352288602
eigmin_vec(v) = -2.036016111521105
Zygote.gradient(eigmin_vec, v) = ([0.1859345500621895, -0.063552114385704, -0.20488568849356967, -0.04763199952618616, -0.063552114385704, 0.32745698121472977, 0.18385591282205427, -0.23483868835745586, -0.20488568849356967, 0.18385591282205427, 0.26814638706116845, -0.04100584354391258, -0.04763199952618616, -0.23483868835745586, -0.04100584354391258, 0.21846208166191233],)
```


### Julia 1.3, with Zygote release

```julia
eigmin(A) = -0.7349214913651515
eigmin_vec(v) = -1.892456581758239
Zygote.gradient(eigmin_vec, v) = ([0.036267358772194266, 0.03459689563090312, -0.07566377621588521, -0.07951750327203881, 0.03459689563090312, 0.2425350991053531, 0.09988932251735495, -0.3036701741814039, -0.07566377621588521, 0.09988932251735495, 0.29915840847990055, -0.02118692682039741, -0.07951750327203881, -0.3036701741814039, -0.02118692682039741, 0.4220391336425522],)
```

## Method ArnoldiMethod.jl

Code:

```julia
using Zygote, LinearAlgebra
using ArnoldiMethod: partialschur, SR

function test_eigmin(A::AbstractMatrix)
    decomp, history = partialschur(A; nev = 1, which = SR())
    ev = minimum(real.(decomp.eigenvalues))
    return ev
end

A = rand(4, 4); A = A + A';

@show eigmin(A)
@show test_eigmin(A)
@show Zygote.gradient(test_eigmin, A)
```

Results:

### Julia 1.1, with Zygote master

```julia
eigmin(A) = -0.7098178829472451
test_eigmin(A) = -0.7098178829472449
ERROR: LoadError: Compiling Tuple{typeof(ArnoldiMethod._partialschur),Array{Float64,2},Type{Float64},Int64,Int64,Int64,Float64,Int64,SR}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:166 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:598
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:611
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:813 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [13] #s2339#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [14] #s2339#1293(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:522
 [16] #partialschur#1 at /home/eric/.julia/packages/ArnoldiMethod/5fDBS/src/run.jl:103 [inlined]
 [17] (::typeof(∂(ArnoldiMethod.#partialschur#1)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [18] #partialschur at ./none:0 [inlined]
 [19] (::typeof(∂(getfield(ArnoldiMethod, Symbol("#kw##partialschur"))())))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [20] (::typeof(∂(test_eigmin)))(::Float64) at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:5
 [21] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [22] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [23] top-level scope at show.jl:555
 [24] include at ./boot.jl:326 [inlined]
 [25] include_relative(::Module, ::String) at ./loading.jl:1038
 [26] include(::Module, ::String) at ./sysimg.jl:29
 [27] exec_options(::Base.JLOptions) at ./client.jl:267
 [28] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:14
```


### Julia 1.2, with Zygote master

```julia
eigmin(A) = -0.9498435632984961
test_eigmin(A) = -0.9498435632984964
ERROR: LoadError: Compiling Tuple{typeof(ArnoldiMethod._partialschur),Array{Float64,2},Type{Float64},Int64,Int64,Int64,Float64,Int64,SR}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:598
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:611
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [13] #s2317#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [14] #s2317#1293(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #partialschur#1 at /home/eric/.julia/packages/ArnoldiMethod/5fDBS/src/run.jl:103 [inlined]
 [17] (::typeof(∂(#partialschur#1)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [18] #partialschur at ./none:0 [inlined]
 [19] (::typeof(∂(#partialschur)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [20] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:5 [inlined]
 [21] (::typeof(∂(test_eigmin)))(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [22] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [23] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [24] top-level scope at show.jl:576
 [25] include at ./boot.jl:328 [inlined]
 [26] include_relative(::Module, ::String) at ./loading.jl:1094
 [27] include(::Module, ::String) at ./Base.jl:31
 [28] exec_options(::Base.JLOptions) at ./client.jl:295
 [29] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:14
```


### Julia 1.3, with Zygote master

```julia
eigmin(A) = -0.9573353459086621
test_eigmin(A) = -0.9573353459086618
ERROR: LoadError: Compiling Tuple{typeof(ArnoldiMethod._partialschur),Array{Float64,2},Type{Float64},Int64,Int64,Int64,Float64,Int64,SR}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:612
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:625
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] IR at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [13] #s2317#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [14] #s2317#1293(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #partialschur#1 at /home/eric/.julia/packages/ArnoldiMethod/5fDBS/src/run.jl:103 [inlined]
 [17] (::typeof(∂(#partialschur#1)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [18] #partialschur at ./none:0 [inlined]
 [19] (::typeof(∂(#partialschur)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [20] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:5 [inlined]
 [21] (::typeof(∂(test_eigmin)))(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [22] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [23] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [24] top-level scope at show.jl:582
 [25] include at ./boot.jl:328 [inlined]
 [26] include_relative(::Module, ::String) at ./loading.jl:1094
 [27] include(::Module, ::String) at ./Base.jl:31
 [28] exec_options(::Base.JLOptions) at ./client.jl:295
 [29] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:14
```


### Julia 1.1, with Zygote release

```julia
eigmin(A) = -1.4971889904441897
test_eigmin(A) = -1.4971889904441895
ERROR: LoadError: Compiling Tuple{typeof(ArnoldiMethod._partialschur),Array{Float64,2},Type{Float64},Int64,Int64,Int64,Float64,Int64,SR}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:166 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:598
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:611
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:813 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [13] #s79#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [14] #s79#1241(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:522
 [16] #partialschur#1 at /home/eric/.julia/packages/ArnoldiMethod/5fDBS/src/run.jl:103 [inlined]
 [17] (::typeof(∂(ArnoldiMethod.#partialschur#1)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [18] #partialschur at ./none:0 [inlined]
 [19] (::typeof(∂(getfield(ArnoldiMethod, Symbol("#kw##partialschur"))())))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [20] (::typeof(∂(test_eigmin)))(::Float64) at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:5
 [21] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [22] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [23] top-level scope at show.jl:555
 [24] include at ./boot.jl:326 [inlined]
 [25] include_relative(::Module, ::String) at ./loading.jl:1038
 [26] include(::Module, ::String) at ./sysimg.jl:29
 [27] exec_options(::Base.JLOptions) at ./client.jl:267
 [28] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:14
```


### Julia 1.2, with Zygote release

```julia
eigmin(A) = -1.4215247890163398
test_eigmin(A) = -1.4215247890163392
ERROR: LoadError: Compiling Tuple{typeof(ArnoldiMethod._partialschur),Array{Float64,2},Type{Float64},Int64,Int64,Int64,Float64,Int64,SR}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:598
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:611
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [13] #s59#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [14] #s59#1241(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #partialschur#1 at /home/eric/.julia/packages/ArnoldiMethod/5fDBS/src/run.jl:103 [inlined]
 [17] (::typeof(∂(#partialschur#1)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [18] #partialschur at ./none:0 [inlined]
 [19] (::typeof(∂(#partialschur)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [20] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:5 [inlined]
 [21] (::typeof(∂(test_eigmin)))(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [22] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [23] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [24] top-level scope at show.jl:576
 [25] include at ./boot.jl:328 [inlined]
 [26] include_relative(::Module, ::String) at ./loading.jl:1094
 [27] include(::Module, ::String) at ./Base.jl:31
 [28] exec_options(::Base.JLOptions) at ./client.jl:295
 [29] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:14
```


### Julia 1.3, with Zygote release

```julia
eigmin(A) = -0.9359337186385737
test_eigmin(A) = -0.9359337186385737
ERROR: LoadError: Compiling Tuple{typeof(ArnoldiMethod._partialschur),Array{Float64,2},Type{Float64},Int64,Int64,Int64,Float64,Int64,SR}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:612
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:625
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] IR at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [13] #s59#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [14] #s59#1241(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #partialschur#1 at /home/eric/.julia/packages/ArnoldiMethod/5fDBS/src/run.jl:103 [inlined]
 [17] (::typeof(∂(#partialschur#1)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [18] #partialschur at ./none:0 [inlined]
 [19] (::typeof(∂(#partialschur)))(::Tuple{NamedTuple{(:Q, :R, :eigenvalues),Tuple{Nothing,Nothing,Array{Float64,1}}},Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [20] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:5 [inlined]
 [21] (::typeof(∂(test_eigmin)))(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [22] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [23] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [24] top-level scope at show.jl:582
 [25] include at ./boot.jl:328 [inlined]
 [26] include_relative(::Module, ::String) at ./loading.jl:1094
 [27] include(::Module, ::String) at ./Base.jl:31
 [28] exec_options(::Base.JLOptions) at ./client.jl:295
 [29] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/ArnoldiMethod.jl:14
```

## Method GenericLinearAlgebra.jl

Code:

```julia
using Zygote, LinearAlgebra
using GenericLinearAlgebra: _eigvals!

function test_eigmin(A::AbstractMatrix)
    vals = _eigvals!(copy(A))
    ev = minimum(real.(vals))
    return ev
end

A = rand(4, 4); A = A + A';

@show eigmin(A)
@show test_eigmin(A)
@show Zygote.gradient(test_eigmin, A)
```

Results:

### Julia 1.1, with Zygote master

```julia
eigmin(A) = -0.9485166717851579
test_eigmin(A) = -0.9485166717851584
ERROR: LoadError: TypeError: in ccall: first argument not a pointer or valid constant expression, expected Ptr, got Tuple{Symbol,String}
Stacktrace:
 [1] _forward(::Zygote.Context, ::typeof(axpy!), ::Int64, ::Float64, ::Ptr{Float64}, ::Int64, ::Ptr{Float64}, ::Int64) at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.1/LinearAlgebra/src/blas.jl:456
 [2] _forward(::Zygote.Context, ::typeof(axpy!), ::Float64, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}) at ./gcutils.jl:87
 [3] lmul! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/householder.jl:64 [inlined]
 [4] _forward(::Zygote.Context, ::typeof(lmul!), ::Adjoint{Float64,GenericLinearAlgebra.Householder{Float64,SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}}}, ::SubArray{Float64,2,Array{Float64,2},Tuple{UnitRange{Int64},UnitRange{Int64}},false}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [5] _forward(::Zygote.Context, ::typeof(GenericLinearAlgebra._hessenberg!), ::Array{Float64,2}) at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:53
 [6] #_schur!#21 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [7] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_schur!#21")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(GenericLinearAlgebra._schur!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [8] _schur! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [9] #_eigvals!#23 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [10] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_eigvals!#23")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(_eigvals!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [11] _eigvals! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [12] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:5 [inlined]
 [13] _forward(::Zygote.Context, ::typeof(test_eigmin), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [14] _forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:31
 [15] forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:37
 [16] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:46
 [17] top-level scope at show.jl:555
 [18] include at ./boot.jl:326 [inlined]
 [19] include_relative(::Module, ::String) at ./loading.jl:1038
 [20] include(::Module, ::String) at ./sysimg.jl:29
 [21] exec_options(::Base.JLOptions) at ./client.jl:267
 [22] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:14
```


### Julia 1.2, with Zygote master

```julia
eigmin(A) = -1.015621038351544
test_eigmin(A) = -1.015621038351544
ERROR: LoadError: TypeError: in ccall: first argument not a pointer or valid constant expression, expected Ptr, got Tuple{Symbol,String}
Stacktrace:
 [1] _forward(::Zygote.Context, ::typeof(axpy!), ::Int64, ::Float64, ::Ptr{Float64}, ::Int64, ::Ptr{Float64}, ::Int64) at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.2/LinearAlgebra/src/blas.jl:456
 [2] _forward(::Zygote.Context, ::typeof(axpy!), ::Float64, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}) at ./gcutils.jl:87
 [3] lmul! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/householder.jl:64 [inlined]
 [4] _forward(::Zygote.Context, ::typeof(lmul!), ::Adjoint{Float64,GenericLinearAlgebra.Householder{Float64,SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}}}, ::SubArray{Float64,2,Array{Float64,2},Tuple{UnitRange{Int64},UnitRange{Int64}},false}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [5] _forward(::Zygote.Context, ::typeof(GenericLinearAlgebra._hessenberg!), ::Array{Float64,2}) at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:53
 [6] #_schur!#21 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [7] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_schur!#21")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(GenericLinearAlgebra._schur!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [8] _schur! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [9] #_eigvals!#23 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [10] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_eigvals!#23")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(_eigvals!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [11] _eigvals! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [12] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:5 [inlined]
 [13] _forward(::Zygote.Context, ::typeof(test_eigmin), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [14] _forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:31
 [15] forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:37
 [16] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:46
 [17] top-level scope at show.jl:576
 [18] include at ./boot.jl:328 [inlined]
 [19] include_relative(::Module, ::String) at ./loading.jl:1094
 [20] include(::Module, ::String) at ./Base.jl:31
 [21] exec_options(::Base.JLOptions) at ./client.jl:295
 [22] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:14
```


### Julia 1.3, with Zygote master

```julia
eigmin(A) = -0.9354003802104077
test_eigmin(A) = -0.9354003802104083
ERROR: LoadError: TypeError: in ccall: first argument not a pointer or valid constant expression, expected Ptr, got Tuple{Symbol,String}
Stacktrace:
 [1] _forward(::Zygote.Context, ::typeof(axpy!), ::Int64, ::Float64, ::Ptr{Float64}, ::Int64, ::Ptr{Float64}, ::Int64) at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.3/LinearAlgebra/src/blas.jl:455
 [2] _forward(::Zygote.Context, ::typeof(axpy!), ::Float64, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}) at ./gcutils.jl:91
 [3] lmul! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/householder.jl:64 [inlined]
 [4] _forward(::Zygote.Context, ::typeof(lmul!), ::Adjoint{Float64,GenericLinearAlgebra.Householder{Float64,SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}}}, ::SubArray{Float64,2,Array{Float64,2},Tuple{UnitRange{Int64},UnitRange{Int64}},false}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [5] _forward(::Zygote.Context, ::typeof(GenericLinearAlgebra._hessenberg!), ::Array{Float64,2}) at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:53
 [6] #_schur!#21 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [7] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_schur!#21")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(GenericLinearAlgebra._schur!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [8] _schur! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [9] #_eigvals!#23 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [10] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_eigvals!#23")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(_eigvals!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [11] _eigvals! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [12] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:5 [inlined]
 [13] _forward(::Zygote.Context, ::typeof(test_eigmin), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [14] _forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:31
 [15] forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:37
 [16] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:46
 [17] top-level scope at show.jl:582
 [18] include at ./boot.jl:328 [inlined]
 [19] include_relative(::Module, ::String) at ./loading.jl:1094
 [20] include(::Module, ::String) at ./Base.jl:31
 [21] exec_options(::Base.JLOptions) at ./client.jl:295
 [22] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:14
```


### Julia 1.1, with Zygote release

```julia
eigmin(A) = -0.35214162301951246
test_eigmin(A) = -0.3521416230195121
ERROR: LoadError: TypeError: in ccall: first argument not a pointer or valid constant expression, expected Ptr, got Tuple{Symbol,String}
Stacktrace:
 [1] _forward(::Zygote.Context, ::typeof(axpy!), ::Int64, ::Float64, ::Ptr{Float64}, ::Int64, ::Ptr{Float64}, ::Int64) at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.1/LinearAlgebra/src/blas.jl:456
 [2] _forward(::Zygote.Context, ::typeof(axpy!), ::Float64, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}) at ./gcutils.jl:87
 [3] lmul! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/householder.jl:64 [inlined]
 [4] _forward(::Zygote.Context, ::typeof(lmul!), ::Adjoint{Float64,GenericLinearAlgebra.Householder{Float64,SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}}}, ::SubArray{Float64,2,Array{Float64,2},Tuple{UnitRange{Int64},UnitRange{Int64}},false}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [5] _hessenberg! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:53 [inlined]
 [6] _forward(::Zygote.Context, ::typeof(GenericLinearAlgebra._hessenberg!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [7] #_schur!#21 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [8] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_schur!#21")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(GenericLinearAlgebra._schur!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [9] _schur! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [10] #_eigvals!#23 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [11] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_eigvals!#23")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(_eigvals!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [12] _eigvals! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [13] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:5 [inlined]
 [14] _forward(::Zygote.Context, ::typeof(test_eigmin), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [15] _forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:31
 [16] forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:37
 [17] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:46
 [18] top-level scope at show.jl:555
 [19] include at ./boot.jl:326 [inlined]
 [20] include_relative(::Module, ::String) at ./loading.jl:1038
 [21] include(::Module, ::String) at ./sysimg.jl:29
 [22] exec_options(::Base.JLOptions) at ./client.jl:267
 [23] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:14
```


### Julia 1.2, with Zygote release

```julia
eigmin(A) = -1.0185551983106431
test_eigmin(A) = -1.0185551983106425
ERROR: LoadError: TypeError: in ccall: first argument not a pointer or valid constant expression, expected Ptr, got Tuple{Symbol,String}
Stacktrace:
 [1] _forward(::Zygote.Context, ::typeof(axpy!), ::Int64, ::Float64, ::Ptr{Float64}, ::Int64, ::Ptr{Float64}, ::Int64) at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.2/LinearAlgebra/src/blas.jl:456
 [2] _forward(::Zygote.Context, ::typeof(axpy!), ::Float64, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}) at ./gcutils.jl:87
 [3] lmul! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/householder.jl:64 [inlined]
 [4] _forward(::Zygote.Context, ::typeof(lmul!), ::Adjoint{Float64,GenericLinearAlgebra.Householder{Float64,SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}}}, ::SubArray{Float64,2,Array{Float64,2},Tuple{UnitRange{Int64},UnitRange{Int64}},false}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [5] _hessenberg! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:53 [inlined]
 [6] _forward(::Zygote.Context, ::typeof(GenericLinearAlgebra._hessenberg!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [7] #_schur!#21 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [8] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_schur!#21")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(GenericLinearAlgebra._schur!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [9] _schur! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [10] #_eigvals!#23 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [11] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_eigvals!#23")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(_eigvals!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [12] _eigvals! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [13] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:5 [inlined]
 [14] _forward(::Zygote.Context, ::typeof(test_eigmin), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [15] _forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:31
 [16] forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:37
 [17] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:46
 [18] top-level scope at show.jl:576
 [19] include at ./boot.jl:328 [inlined]
 [20] include_relative(::Module, ::String) at ./loading.jl:1094
 [21] include(::Module, ::String) at ./Base.jl:31
 [22] exec_options(::Base.JLOptions) at ./client.jl:295
 [23] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:14
```


### Julia 1.3, with Zygote release

```julia
eigmin(A) = -0.31054858071639524
test_eigmin(A) = -0.31054858071639524
ERROR: LoadError: TypeError: in ccall: first argument not a pointer or valid constant expression, expected Ptr, got Tuple{Symbol,String}
Stacktrace:
 [1] _forward(::Zygote.Context, ::typeof(axpy!), ::Int64, ::Float64, ::Ptr{Float64}, ::Int64, ::Ptr{Float64}, ::Int64) at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.3/LinearAlgebra/src/blas.jl:455
 [2] _forward(::Zygote.Context, ::typeof(axpy!), ::Float64, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}, ::SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}) at ./gcutils.jl:91
 [3] lmul! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/householder.jl:64 [inlined]
 [4] _forward(::Zygote.Context, ::typeof(lmul!), ::Adjoint{Float64,GenericLinearAlgebra.Householder{Float64,SubArray{Float64,1,Array{Float64,2},Tuple{UnitRange{Int64},Int64},true}}}, ::SubArray{Float64,2,Array{Float64,2},Tuple{UnitRange{Int64},UnitRange{Int64}},false}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [5] _hessenberg! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:53 [inlined]
 [6] _forward(::Zygote.Context, ::typeof(GenericLinearAlgebra._hessenberg!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [7] #_schur!#21 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [8] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_schur!#21")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(GenericLinearAlgebra._schur!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [9] _schur! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:164 [inlined]
 [10] #_eigvals!#23 at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [11] _forward(::Zygote.Context, ::getfield(GenericLinearAlgebra, Symbol("##_eigvals!#23")), ::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}, ::typeof(_eigvals!), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [12] _eigvals! at /home/eric/.julia/packages/GenericLinearAlgebra/Lme7U/src/eigenGeneral.jl:241 [inlined]
 [13] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:5 [inlined]
 [14] _forward(::Zygote.Context, ::typeof(test_eigmin), ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [15] _forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:31
 [16] forward(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:37
 [17] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:46
 [18] top-level scope at show.jl:582
 [19] include at ./boot.jl:328 [inlined]
 [20] include_relative(::Module, ::String) at ./loading.jl:1094
 [21] include(::Module, ::String) at ./Base.jl:31
 [22] exec_options(::Base.JLOptions) at ./client.jl:295
 [23] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/GenericLinearAlgebra.jl:14
```

## Method IterativeSolvers.jl

Code:

```julia
using Zygote, LinearAlgebra
using IterativeSolvers: lobpcg

function test_eigmin(A::AbstractMatrix)
    results = lobpcg(A, false, 1)
    ev = minimum(results.λ)
    return ev
end

A = rand(4, 4); A = A + A';

@show eigmin(A)
@show test_eigmin(A)
@show Zygote.gradient(test_eigmin, A)
```

Results:

### Julia 1.1, with Zygote master

```julia
eigmin(A) = -0.1451628767986209
test_eigmin(A) = -0.14516287679847817
ERROR: LoadError: Compiling Tuple{getfield(IterativeSolvers, Symbol("##lobpcg!#53")),Bool,Int64,Bool,Float64,typeof(IterativeSolvers.lobpcg!),IterativeSolvers.LOBPCGIterator{false,Float64,Array{Float64,2},Nothing,Array{Float64,1},Array{Float64,1},Array{Int64,1},Array{Float64,2},IterativeSolvers.Blocks{false,Float64,Array{Float64,2}},IterativeSolvers.CholQR{Array{Float64,2}},IterativeSolvers.RPreconditioner{Nothing,Float64,Array{Float64,2}},IterativeSolvers.Constraint{Nothing,Array{Nothing,2},Array{Nothing,2},Nothing},IterativeSolvers.BlockGram{false,Array{Float64,2}},Array{Bool,1},Array{IterativeSolvers.LOBPCGState{Array{Float64,1},Array{Float64,1}},1}}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:166 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for at ./array.jl:598 [inlined]
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:608
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:813 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [13] #s2339#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [14] #s2339#1293(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:522
 [16] #lobpcg! at ./none:0 [inlined]
 [17] (::typeof(∂(getfield(IterativeSolvers, Symbol("#kw##lobpcg!"))())))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [18] #lobpcg#52 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:837 [inlined]
 [19] (::typeof(∂(IterativeSolvers.#lobpcg#52)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [20] #lobpcg at ./none:0 [inlined]
 [21] (::typeof(∂(getfield(IterativeSolvers, Symbol("#kw##lobpcg"))())))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [22] #lobpcg#50 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [23] (::typeof(∂(IterativeSolvers.#lobpcg#50)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [24] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [25] (::typeof(∂(IterativeSolvers.lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [26] #lobpcg#49 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [27] (::typeof(∂(IterativeSolvers.#lobpcg#49)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [28] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [29] (::typeof(∂(IterativeSolvers.lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [30] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:5 [inlined]
 [31] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [32] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [33] top-level scope at show.jl:555
 [34] include at ./boot.jl:326 [inlined]
 [35] include_relative(::Module, ::String) at ./loading.jl:1038
 [36] include(::Module, ::String) at ./sysimg.jl:29
 [37] exec_options(::Base.JLOptions) at ./client.jl:267
 [38] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:14
```


### Julia 1.2, with Zygote master

```julia
eigmin(A) = -0.7972793397804492
test_eigmin(A) = -0.7972793397734711
ERROR: LoadError: Compiling Tuple{getfield(IterativeSolvers, Symbol("##lobpcg!#53")),Bool,Int64,Bool,Float64,typeof(IterativeSolvers.lobpcg!),IterativeSolvers.LOBPCGIterator{false,Float64,Array{Float64,2},Nothing,Array{Float64,1},Array{Float64,1},Array{Int64,1},Array{Float64,2},IterativeSolvers.Blocks{false,Float64,Array{Float64,2}},IterativeSolvers.CholQR{Array{Float64,2}},IterativeSolvers.RPreconditioner{Nothing,Float64,Array{Float64,2}},IterativeSolvers.Constraint{Nothing,Array{Nothing,2},Array{Nothing,2},Nothing},IterativeSolvers.BlockGram{false,Array{Float64,2}},Array{Bool,1},Array{IterativeSolvers.LOBPCGState{Array{Float64,1},Array{Float64,1}},1}}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for at ./array.jl:598 [inlined]
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:608
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [13] #s2317#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [14] #s2317#1293(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #lobpcg! at ./none:0 [inlined]
 [17] (::typeof(∂(#lobpcg!)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [18] #lobpcg#52 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:837 [inlined]
 [19] (::typeof(∂(#lobpcg#52)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [20] #lobpcg at ./none:0 [inlined]
 [21] (::typeof(∂(#lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [22] #lobpcg#50 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [23] (::typeof(∂(#lobpcg#50)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [24] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [25] (::typeof(∂(lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [26] #lobpcg#49 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [27] (::typeof(∂(#lobpcg#49)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [28] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [29] (::typeof(∂(lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [30] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:5 [inlined]
 [31] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [32] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [33] top-level scope at show.jl:576
 [34] include at ./boot.jl:328 [inlined]
 [35] include_relative(::Module, ::String) at ./loading.jl:1094
 [36] include(::Module, ::String) at ./Base.jl:31
 [37] exec_options(::Base.JLOptions) at ./client.jl:295
 [38] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:14
```


### Julia 1.3, with Zygote master

```julia
eigmin(A) = -0.8218485214025941
test_eigmin(A) = -0.8218485213883866
ERROR: LoadError: Compiling Tuple{getfield(IterativeSolvers, Symbol("##lobpcg!#53")),Bool,Int64,Bool,Float64,typeof(IterativeSolvers.lobpcg!),IterativeSolvers.LOBPCGIterator{false,Float64,Array{Float64,2},Nothing,Array{Float64,1},Array{Float64,1},Array{Int64,1},Array{Float64,2},IterativeSolvers.Blocks{false,Float64,Array{Float64,2}},IterativeSolvers.CholQR{Array{Float64,2}},IterativeSolvers.RPreconditioner{Nothing,Float64,Array{Float64,2}},IterativeSolvers.Constraint{Nothing,Array{Nothing,2},Array{Nothing,2},Nothing},IterativeSolvers.BlockGram{false,Array{Float64,2}},Array{Bool,1},Array{IterativeSolvers.LOBPCGState{Array{Float64,1},Array{Float64,1}},1}}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for at ./array.jl:612 [inlined]
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:622
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] IR at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [13] #s2317#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [14] #s2317#1293(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #lobpcg! at ./none:0 [inlined]
 [17] (::typeof(∂(#lobpcg!)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [18] #lobpcg#52 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:837 [inlined]
 [19] (::typeof(∂(#lobpcg#52)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [20] #lobpcg at ./none:0 [inlined]
 [21] (::typeof(∂(#lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [22] #lobpcg#50 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [23] (::typeof(∂(#lobpcg#50)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [24] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [25] (::typeof(∂(lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [26] #lobpcg#49 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [27] (::typeof(∂(#lobpcg#49)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [28] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [29] (::typeof(∂(lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [30] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:5 [inlined]
 [31] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [32] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [33] top-level scope at show.jl:582
 [34] include at ./boot.jl:328 [inlined]
 [35] include_relative(::Module, ::String) at ./loading.jl:1094
 [36] include(::Module, ::String) at ./Base.jl:31
 [37] exec_options(::Base.JLOptions) at ./client.jl:295
 [38] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:14
```


### Julia 1.1, with Zygote release

```julia
eigmin(A) = -0.7703049856961236
test_eigmin(A) = -0.7703049855998795
ERROR: LoadError: Compiling Tuple{getfield(IterativeSolvers, Symbol("##lobpcg!#53")),Bool,Int64,Bool,Float64,typeof(IterativeSolvers.lobpcg!),IterativeSolvers.LOBPCGIterator{false,Float64,Array{Float64,2},Nothing,Array{Float64,1},Array{Float64,1},Array{Int64,1},Array{Float64,2},IterativeSolvers.Blocks{false,Float64,Array{Float64,2}},IterativeSolvers.CholQR{Array{Float64,2}},IterativeSolvers.RPreconditioner{Nothing,Float64,Array{Float64,2}},IterativeSolvers.Constraint{Nothing,Array{Nothing,2},Array{Nothing,2},Nothing},IterativeSolvers.BlockGram{false,Array{Float64,2}},Array{Bool,1},Array{IterativeSolvers.LOBPCGState{Array{Float64,1},Array{Float64,1}},1}}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:166 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for at ./array.jl:598 [inlined]
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:608
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:813 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [13] #s79#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [14] #s79#1241(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:522
 [16] #lobpcg! at ./none:0 [inlined]
 [17] (::typeof(∂(getfield(IterativeSolvers, Symbol("#kw##lobpcg!"))())))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [18] #lobpcg#52 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:837 [inlined]
 [19] (::typeof(∂(IterativeSolvers.#lobpcg#52)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [20] #lobpcg at ./none:0 [inlined]
 [21] (::typeof(∂(getfield(IterativeSolvers, Symbol("#kw##lobpcg"))())))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [22] #lobpcg#50 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [23] (::typeof(∂(IterativeSolvers.#lobpcg#50)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [24] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [25] (::typeof(∂(IterativeSolvers.lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [26] #lobpcg#49 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [27] (::typeof(∂(IterativeSolvers.#lobpcg#49)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [28] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [29] (::typeof(∂(IterativeSolvers.lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [30] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:5 [inlined]
 [31] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [32] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [33] top-level scope at show.jl:555
 [34] include at ./boot.jl:326 [inlined]
 [35] include_relative(::Module, ::String) at ./loading.jl:1038
 [36] include(::Module, ::String) at ./sysimg.jl:29
 [37] exec_options(::Base.JLOptions) at ./client.jl:267
 [38] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:14
```


### Julia 1.2, with Zygote release

```julia
eigmin(A) = -0.9803941122091208
test_eigmin(A) = -0.9803941122077289
ERROR: LoadError: Compiling Tuple{getfield(IterativeSolvers, Symbol("##lobpcg!#53")),Bool,Int64,Bool,Float64,typeof(IterativeSolvers.lobpcg!),IterativeSolvers.LOBPCGIterator{false,Float64,Array{Float64,2},Nothing,Array{Float64,1},Array{Float64,1},Array{Int64,1},Array{Float64,2},IterativeSolvers.Blocks{false,Float64,Array{Float64,2}},IterativeSolvers.CholQR{Array{Float64,2}},IterativeSolvers.RPreconditioner{Nothing,Float64,Array{Float64,2}},IterativeSolvers.Constraint{Nothing,Array{Nothing,2},Array{Nothing,2},Nothing},IterativeSolvers.BlockGram{false,Array{Float64,2}},Array{Bool,1},Array{IterativeSolvers.LOBPCGState{Array{Float64,1},Array{Float64,1}},1}}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for at ./array.jl:598 [inlined]
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:608
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [13] #s59#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [14] #s59#1241(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #lobpcg! at ./none:0 [inlined]
 [17] (::typeof(∂(#lobpcg!)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [18] #lobpcg#52 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:837 [inlined]
 [19] (::typeof(∂(#lobpcg#52)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [20] #lobpcg at ./none:0 [inlined]
 [21] (::typeof(∂(#lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [22] #lobpcg#50 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [23] (::typeof(∂(#lobpcg#50)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [24] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [25] (::typeof(∂(lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [26] #lobpcg#49 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [27] (::typeof(∂(#lobpcg#49)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [28] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [29] (::typeof(∂(lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [30] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:5 [inlined]
 [31] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [32] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [33] top-level scope at show.jl:576
 [34] include at ./boot.jl:328 [inlined]
 [35] include_relative(::Module, ::String) at ./loading.jl:1094
 [36] include(::Module, ::String) at ./Base.jl:31
 [37] exec_options(::Base.JLOptions) at ./client.jl:295
 [38] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:14
```


### Julia 1.3, with Zygote release

```julia
eigmin(A) = -0.6002068839980714
test_eigmin(A) = -0.6002068839577935
ERROR: LoadError: Compiling Tuple{getfield(IterativeSolvers, Symbol("##lobpcg!#53")),Bool,Int64,Bool,Float64,typeof(IterativeSolvers.lobpcg!),IterativeSolvers.LOBPCGIterator{false,Float64,Array{Float64,2},Nothing,Array{Float64,1},Array{Float64,1},Array{Int64,1},Array{Float64,2},IterativeSolvers.Blocks{false,Float64,Array{Float64,2}},IterativeSolvers.CholQR{Array{Float64,2}},IterativeSolvers.RPreconditioner{Nothing,Float64,Array{Float64,2}},IterativeSolvers.Constraint{Nothing,Array{Nothing,2},Array{Nothing,2},Nothing},IterativeSolvers.BlockGram{false,Array{Float64,2}},Array{Bool,1},Array{IterativeSolvers.LOBPCGState{Array{Float64,1},Array{Float64,1}},1}}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for at ./array.jl:612 [inlined]
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:622
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] IR at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [13] #s59#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [14] #s59#1241(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #lobpcg! at ./none:0 [inlined]
 [17] (::typeof(∂(#lobpcg!)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [18] #lobpcg#52 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:837 [inlined]
 [19] (::typeof(∂(#lobpcg#52)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [20] #lobpcg at ./none:0 [inlined]
 [21] (::typeof(∂(#lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [22] #lobpcg#50 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [23] (::typeof(∂(#lobpcg#50)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [24] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:791 [inlined]
 [25] (::typeof(∂(lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [26] #lobpcg#49 at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [27] (::typeof(∂(#lobpcg#49)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [28] lobpcg at /home/eric/.julia/packages/IterativeSolvers/QuajJ/src/lobpcg.jl:788 [inlined]
 [29] (::typeof(∂(lobpcg)))(::NamedTuple{(:λ, :X, :tolerance, :residual_norms, :iterations, :maxiter, :converged, :trace),Tuple{Array{Float64,1},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing}}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [30] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:5 [inlined]
 [31] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [32] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [33] top-level scope at show.jl:582
 [34] include at ./boot.jl:328 [inlined]
 [35] include_relative(::Module, ::String) at ./loading.jl:1094
 [36] include(::Module, ::String) at ./Base.jl:31
 [37] exec_options(::Base.JLOptions) at ./client.jl:295
 [38] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/IterativeSolvers.jl:14
```

## Method KrylovKit.jl

Code:

```julia
using Zygote, LinearAlgebra
using KrylovKit: eigsolve

test_eigmin(A::AbstractMatrix) = eigsolve(A, 1, :SR)[1][1]

A = rand(4, 4); A = A + A';

@show eigmin(A)
@show test_eigmin(A)
@show Zygote.gradient(test_eigmin, A)
```

Results:

### Julia 1.1, with Zygote master

```julia
eigmin(A) = -0.1697483480758236
test_eigmin(A) = -0.16974834807582354
ERROR: LoadError: Compiling Tuple{typeof(eigsolve),Array{Float64,2},Array{Float64,1},Int64,Symbol,KrylovKit.Lanczos{KrylovKit.ModifiedGramSchmidt2,Float64}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:166 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:598
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:611
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:813 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [13] #s2339#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [14] #s2339#1293(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:522
 [16] #eigsolve#41 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:163 [inlined]
 [17] (::typeof(∂(KrylovKit.#eigsolve#41)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [18] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:149 [inlined]
 [19] (::typeof(∂(KrylovKit.eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [20] #eigsolve#39 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [21] (::typeof(∂(KrylovKit.#eigsolve#39)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [22] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [23] (::typeof(∂(KrylovKit.eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [24] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [25] (::typeof(∂(KrylovKit.eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [26] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:4 [inlined]
 [27] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [28] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [29] top-level scope at show.jl:555
 [30] include at ./boot.jl:326 [inlined]
 [31] include_relative(::Module, ::String) at ./loading.jl:1038
 [32] include(::Module, ::String) at ./sysimg.jl:29
 [33] exec_options(::Base.JLOptions) at ./client.jl:267
 [34] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:10
```


### Julia 1.2, with Zygote master

```julia
eigmin(A) = 0.17794220825227455
test_eigmin(A) = 0.17794220825227472
ERROR: LoadError: Compiling Tuple{typeof(eigsolve),Array{Float64,2},Array{Float64,1},Int64,Symbol,KrylovKit.Lanczos{KrylovKit.ModifiedGramSchmidt2,Float64}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:598
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:611
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [13] #s2317#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [14] #s2317#1293(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #eigsolve#41 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:163 [inlined]
 [17] (::typeof(∂(#eigsolve#41)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [18] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:149 [inlined]
 [19] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [20] #eigsolve#39 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [21] (::typeof(∂(#eigsolve#39)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [22] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [23] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [24] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [25] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [26] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:4 [inlined]
 [27] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [28] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [29] top-level scope at show.jl:576
 [30] include at ./boot.jl:328 [inlined]
 [31] include_relative(::Module, ::String) at ./loading.jl:1094
 [32] include(::Module, ::String) at ./Base.jl:31
 [33] exec_options(::Base.JLOptions) at ./client.jl:295
 [34] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:10
```


### Julia 1.3, with Zygote master

```julia
eigmin(A) = -0.6709656419221234
test_eigmin(A) = -0.6709656419221234
ERROR: LoadError: Compiling Tuple{typeof(eigsolve),Array{Float64,2},Array{Float64,1},Int64,Symbol,KrylovKit.Lanczos{KrylovKit.ModifiedGramSchmidt2,Float64}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:612
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:625
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] IR at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [13] #s2317#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [14] #s2317#1293(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #eigsolve#41 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:163 [inlined]
 [17] (::typeof(∂(#eigsolve#41)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [18] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:149 [inlined]
 [19] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [20] #eigsolve#39 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [21] (::typeof(∂(#eigsolve#39)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [22] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [23] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [24] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [25] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [26] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:4 [inlined]
 [27] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [28] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [29] top-level scope at show.jl:582
 [30] include at ./boot.jl:328 [inlined]
 [31] include_relative(::Module, ::String) at ./loading.jl:1094
 [32] include(::Module, ::String) at ./Base.jl:31
 [33] exec_options(::Base.JLOptions) at ./client.jl:295
 [34] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:10
```


### Julia 1.1, with Zygote release

```julia
eigmin(A) = -0.04668495797915918
test_eigmin(A) = -0.04668495797915982
ERROR: LoadError: Compiling Tuple{typeof(eigsolve),Array{Float64,2},Array{Float64,1},Int64,Symbol,KrylovKit.Lanczos{KrylovKit.ModifiedGramSchmidt2,Float64}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:166 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:598
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:611
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:813 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [13] #s79#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [14] #s79#1241(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:522
 [16] #eigsolve#41 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:163 [inlined]
 [17] (::typeof(∂(KrylovKit.#eigsolve#41)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [18] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:149 [inlined]
 [19] (::typeof(∂(KrylovKit.eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [20] #eigsolve#39 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [21] (::typeof(∂(KrylovKit.#eigsolve#39)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [22] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [23] (::typeof(∂(KrylovKit.eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [24] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [25] (::typeof(∂(KrylovKit.eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [26] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:4 [inlined]
 [27] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [28] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [29] top-level scope at show.jl:555
 [30] include at ./boot.jl:326 [inlined]
 [31] include_relative(::Module, ::String) at ./loading.jl:1038
 [32] include(::Module, ::String) at ./sysimg.jl:29
 [33] exec_options(::Base.JLOptions) at ./client.jl:267
 [34] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:10
```


### Julia 1.2, with Zygote release

```julia
eigmin(A) = -0.4678088575873383
test_eigmin(A) = -0.46780885758733864
ERROR: LoadError: Compiling Tuple{typeof(eigsolve),Array{Float64,2},Array{Float64,1},Int64,Symbol,KrylovKit.Lanczos{KrylovKit.ModifiedGramSchmidt2,Float64}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:598
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:611
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] Type at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [13] #s59#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [14] #s59#1241(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #eigsolve#41 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:163 [inlined]
 [17] (::typeof(∂(#eigsolve#41)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [18] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:149 [inlined]
 [19] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [20] #eigsolve#39 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [21] (::typeof(∂(#eigsolve#39)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [22] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [23] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [24] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [25] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [26] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:4 [inlined]
 [27] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [28] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [29] top-level scope at show.jl:576
 [30] include at ./boot.jl:328 [inlined]
 [31] include_relative(::Module, ::String) at ./loading.jl:1094
 [32] include(::Module, ::String) at ./Base.jl:31
 [33] exec_options(::Base.JLOptions) at ./client.jl:295
 [34] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:10
```


### Julia 1.3, with Zygote release

```julia
eigmin(A) = -0.9430429128472988
test_eigmin(A) = -0.9430429128472991
ERROR: LoadError: Compiling Tuple{typeof(eigsolve),Array{Float64,2},Array{Float64,1},Int64,Symbol,KrylovKit.Lanczos{KrylovKit.ModifiedGramSchmidt2,Float64}}: DimensionMismatch("dimensions must match")
Stacktrace:
 [1] promote_shape at ./indices.jl:154 [inlined]
 [2] _promote_shape at ./iterators.jl:317 [inlined]
 [3] axes at ./iterators.jl:316 [inlined]
 [4] map at ./tuple.jl:140 [inlined]
 [5] axes at ./iterators.jl:316 [inlined]
 [6] _array_for(::Type{Array{IRTools.Variable,1}}, ::Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}}, ::Base.HasShape{1}) at ./array.jl:612
 [7] collect(::Base.Generator{Base.Iterators.Zip{Tuple{Array{Any,1},Base.Iterators.Zip{Tuple{Array{Any,1},Array{Any,1}}}}},getfield(IRTools, Symbol("##126#132"))}) at ./array.jl:625
 [8] prune!(::IRTools.IR) at /home/eric/.julia/packages/IRTools/y0Ot8/src/passes/passes.jl:121
 [9] |> at ./operators.jl:854 [inlined]
 [10] #IR#23(::Bool, ::Bool, ::Type{IRTools.IR}, ::IRTools.Meta) at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:195
 [11] IR at /home/eric/.julia/packages/IRTools/y0Ot8/src/ir/wrap.jl:190 [inlined]
 [12] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [13] #s59#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [14] #s59#1241(::Any, ::Any, ::Any) at ./none:0
 [15] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [16] #eigsolve#41 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:163 [inlined]
 [17] (::typeof(∂(#eigsolve#41)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [18] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:149 [inlined]
 [19] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [20] #eigsolve#39 at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [21] (::typeof(∂(#eigsolve#39)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [22] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [23] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [24] eigsolve at /home/eric/.julia/packages/KrylovKit/kSkwM/src/eigsolve/eigsolve.jl:144 [inlined]
 [25] (::typeof(∂(eigsolve)))(::Tuple{Array{Float64,1},Nothing,Nothing}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [26] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:4 [inlined]
 [27] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [28] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [29] top-level scope at show.jl:582
 [30] include at ./boot.jl:328 [inlined]
 [31] include_relative(::Module, ::String) at ./loading.jl:1094
 [32] include(::Module, ::String) at ./Base.jl:31
 [33] exec_options(::Base.JLOptions) at ./client.jl:295
 [34] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/KrylovKit.jl:10
```

## Method PyTorch via PyCall.jl

Code:

```julia
using Zygote, LinearAlgebra
using PyCall
# Make sure pytorch is installed

torch = pyimport("torch")

# From Mike Innes' JuliaCon 2019 talk
# https://youtu.be/OcUXjk7DFvU?t=1106
Zygote.@adjoint function pycall(f, x...; kw...)
    x = map(py, x)
    y = pycall(f, x...; kw...)
    y.detach().numpy(), function (ȳ)
        y.backward(gradient = py(ȳ))
        (nothing, map(x->x.grad.numpy(), x)...)
    end
end

# Non-symmetric version, which gives complex eigenvalues
# function torch_eig(A)
#     tA = torch.from_numpy(A)
#     out = torch.eig(tA)
#     evs = out[1].numpy()
#     return [ evs[j, 1] + im*evs[j,2] for j = 1:size(evs,1) ]
# end

function torch_symeig(A)
    tA = torch.from_numpy(A)
    out = torch.symeig(tA)
    evs = out[1].numpy()
    return evs
end

function test_eigmin(A)
    evals = torch_symeig(A)
    return minimum(evals)
end


A = rand(4, 4); A = A + A';
@show eigmin(A)
@show test_eigmin(A)
@show Zygote.gradient(test_eigmin, A)
```

Results:

### Julia 1.1, with Zygote master

```julia
eigmin(A) = -1.6789179174576487
test_eigmin(A) = -1.6789179174576487
ERROR: LoadError: Compiling Tuple{typeof(convert),Type{PyAny},PyObject}: try/catch is not supported.
Stacktrace:
 [1] error(::String) at ./error.jl:33
 [2] instrument(::IRTools.IR) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/reverse.jl:88
 [3] #Primal#8 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/reverse.jl:179 [inlined]
 [4] Type at ./none:0 [inlined]
 [5] #Adjoint#24(::Nothing, ::Bool, ::Type, ::IRTools.IR) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/reverse.jl:292
 [6] (::getfield(Core, Symbol("#kw#Type")))(::NamedTuple{(:varargs, :normalise),Tuple{Nothing,Bool}}, ::Type{Zygote.Adjoint}, ::IRTools.IR) at ./none:0
 [7] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [8] #s2339#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [9] #s2339#1293(::Any, ::Any, ::Any) at ./none:0
 [10] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:522
 [11] #call#111 at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [12] (::typeof(∂(PyCall.#call#111)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [13] #135 at /home/eric/.julia/packages/Zygote/SnR3X/src/lib/lib.jl:129 [inlined]
 [14] #259#back at /home/eric/.julia/packages/ZygoteRules/icdMr/src/adjoint.jl:48 [inlined]
 [15] PyObject at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [16] (::typeof(∂(λ)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [17] torch_symeig at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:29 [inlined]
 [18] (::typeof(∂(torch_symeig)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [19] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:34 [inlined]
 [20] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [21] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [22] top-level scope at show.jl:555
 [23] include at ./boot.jl:326 [inlined]
 [24] include_relative(::Module, ::String) at ./loading.jl:1038
 [25] include(::Module, ::String) at ./sysimg.jl:29
 [26] exec_options(::Base.JLOptions) at ./client.jl:267
 [27] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:42
```


### Julia 1.2, with Zygote master

```julia
eigmin(A) = -0.7290563611351771
test_eigmin(A) = -0.729056361135177
ERROR: LoadError: Compiling Tuple{typeof(convert),Type{PyAny},PyObject}: try/catch is not supported.
Stacktrace:
 [1] error(::String) at ./error.jl:33
 [2] instrument(::IRTools.IR) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/reverse.jl:88
 [3] #Primal#8 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/reverse.jl:179 [inlined]
 [4] Type at ./none:0 [inlined]
 [5] #Adjoint#24(::Nothing, ::Bool, ::Type{Zygote.Adjoint}, ::IRTools.IR) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/reverse.jl:292
 [6] (::getfield(Core, Symbol("#kw#Type")))(::NamedTuple{(:varargs, :normalise),Tuple{Nothing,Bool}}, ::Type{Zygote.Adjoint}, ::IRTools.IR) at ./none:0
 [7] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [8] #s2317#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [9] #s2317#1293(::Any, ::Any, ::Any) at ./none:0
 [10] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [11] #call#111 at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [12] (::typeof(∂(#call#111)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [13] #135 at /home/eric/.julia/packages/Zygote/SnR3X/src/lib/lib.jl:129 [inlined]
 [14] #237#back at /home/eric/.julia/packages/ZygoteRules/icdMr/src/adjoint.jl:48 [inlined]
 [15] PyObject at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [16] (::typeof(∂(λ)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [17] torch_symeig at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:29 [inlined]
 [18] (::typeof(∂(torch_symeig)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [19] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:34 [inlined]
 [20] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [21] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [22] top-level scope at show.jl:576
 [23] include at ./boot.jl:328 [inlined]
 [24] include_relative(::Module, ::String) at ./loading.jl:1094
 [25] include(::Module, ::String) at ./Base.jl:31
 [26] exec_options(::Base.JLOptions) at ./client.jl:295
 [27] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:42
```


### Julia 1.3, with Zygote master

```julia
eigmin(A) = -0.7968502242227006
test_eigmin(A) = -0.7968502242227018
ERROR: LoadError: Compiling Tuple{typeof(convert),Type{PyAny},PyObject}: try/catch is not supported.
Stacktrace:
 [1] error(::String) at ./error.jl:33
 [2] instrument(::IRTools.IR) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/reverse.jl:88
 [3] #Primal#8 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/reverse.jl:179 [inlined]
 [4] Type at ./none:0 [inlined]
 [5] #Adjoint#24(::Nothing, ::Bool, ::Type{Zygote.Adjoint}, ::IRTools.IR) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/reverse.jl:292
 [6] (::getfield(Core, Symbol("#kw#Type")))(::NamedTuple{(:varargs, :normalise),Tuple{Nothing,Bool}}, ::Type{Zygote.Adjoint}, ::IRTools.IR) at ./none:0
 [7] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/emit.jl:117
 [8] #s2317#1293 at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:20 [inlined]
 [9] #s2317#1293(::Any, ::Any, ::Any) at ./none:0
 [10] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [11] #call#111 at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [12] (::typeof(∂(#call#111)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [13] #135 at /home/eric/.julia/packages/Zygote/SnR3X/src/lib/lib.jl:129 [inlined]
 [14] #237#back at /home/eric/.julia/packages/ZygoteRules/icdMr/src/adjoint.jl:48 [inlined]
 [15] PyObject at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [16] (::typeof(∂(λ)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [17] torch_symeig at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:29 [inlined]
 [18] (::typeof(∂(torch_symeig)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface2.jl:0
 [19] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:34 [inlined]
 [20] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:38
 [21] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/SnR3X/src/compiler/interface.jl:47
 [22] top-level scope at show.jl:582
 [23] include at ./boot.jl:328 [inlined]
 [24] include_relative(::Module, ::String) at ./loading.jl:1094
 [25] include(::Module, ::String) at ./Base.jl:31
 [26] exec_options(::Base.JLOptions) at ./client.jl:295
 [27] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:42
```


### Julia 1.1, with Zygote release

```julia
eigmin(A) = -1.5283051249176698
test_eigmin(A) = -1.5283051249176705
ERROR: LoadError: Compiling Tuple{typeof(convert),Type{PyAny},PyObject}: try/catch is not supported.
Stacktrace:
 [1] error(::String) at ./error.jl:33
 [2] instrument(::IRTools.IR) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/reverse.jl:88
 [3] #Primal#8 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/reverse.jl:179 [inlined]
 [4] Type at ./none:0 [inlined]
 [5] #Adjoint#24(::Nothing, ::Bool, ::Type, ::IRTools.IR) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/reverse.jl:292
 [6] (::getfield(Core, Symbol("#kw#Type")))(::NamedTuple{(:varargs, :normalise),Tuple{Nothing,Bool}}, ::Type{Zygote.Adjoint}, ::IRTools.IR) at ./none:0
 [7] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [8] #s79#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [9] #s79#1241(::Any, ::Any, ::Any) at ./none:0
 [10] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:522
 [11] #call#111 at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [12] (::typeof(∂(PyCall.#call#111)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [13] #135 at /home/eric/.julia/packages/Zygote/fuj2C/src/lib/lib.jl:129 [inlined]
 [14] #260#back at /home/eric/.julia/packages/Zygote/fuj2C/src/lib/grad.jl:46 [inlined]
 [15] PyObject at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [16] (::typeof(∂(λ)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [17] torch_symeig at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:29 [inlined]
 [18] (::typeof(∂(torch_symeig)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [19] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:34 [inlined]
 [20] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [21] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [22] top-level scope at show.jl:555
 [23] include at ./boot.jl:326 [inlined]
 [24] include_relative(::Module, ::String) at ./loading.jl:1038
 [25] include(::Module, ::String) at ./sysimg.jl:29
 [26] exec_options(::Base.JLOptions) at ./client.jl:267
 [27] _start() at ./client.jl:436
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:42
```


### Julia 1.2, with Zygote release

```julia
eigmin(A) = -0.6015739042055829
test_eigmin(A) = -0.6015739042055827
ERROR: LoadError: Compiling Tuple{typeof(convert),Type{PyAny},PyObject}: try/catch is not supported.
Stacktrace:
 [1] error(::String) at ./error.jl:33
 [2] instrument(::IRTools.IR) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/reverse.jl:88
 [3] #Primal#8 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/reverse.jl:179 [inlined]
 [4] Type at ./none:0 [inlined]
 [5] #Adjoint#24(::Nothing, ::Bool, ::Type{Zygote.Adjoint}, ::IRTools.IR) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/reverse.jl:292
 [6] (::getfield(Core, Symbol("#kw#Type")))(::NamedTuple{(:varargs, :normalise),Tuple{Nothing,Bool}}, ::Type{Zygote.Adjoint}, ::IRTools.IR) at ./none:0
 [7] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [8] #s59#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [9] #s59#1241(::Any, ::Any, ::Any) at ./none:0
 [10] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [11] #call#111 at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [12] (::typeof(∂(#call#111)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [13] #135 at /home/eric/.julia/packages/Zygote/fuj2C/src/lib/lib.jl:129 [inlined]
 [14] #238#back at /home/eric/.julia/packages/Zygote/fuj2C/src/lib/grad.jl:46 [inlined]
 [15] PyObject at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [16] (::typeof(∂(λ)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [17] torch_symeig at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:29 [inlined]
 [18] (::typeof(∂(torch_symeig)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [19] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:34 [inlined]
 [20] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [21] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [22] top-level scope at show.jl:576
 [23] include at ./boot.jl:328 [inlined]
 [24] include_relative(::Module, ::String) at ./loading.jl:1094
 [25] include(::Module, ::String) at ./Base.jl:31
 [26] exec_options(::Base.JLOptions) at ./client.jl:295
 [27] _start() at ./client.jl:464
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:42
```


### Julia 1.3, with Zygote release

```julia
eigmin(A) = -0.5616953891904817
test_eigmin(A) = -0.5616953891904817
ERROR: LoadError: Compiling Tuple{typeof(convert),Type{PyAny},PyObject}: try/catch is not supported.
Stacktrace:
 [1] error(::String) at ./error.jl:33
 [2] instrument(::IRTools.IR) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/reverse.jl:88
 [3] #Primal#8 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/reverse.jl:179 [inlined]
 [4] Type at ./none:0 [inlined]
 [5] #Adjoint#24(::Nothing, ::Bool, ::Type{Zygote.Adjoint}, ::IRTools.IR) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/reverse.jl:292
 [6] (::getfield(Core, Symbol("#kw#Type")))(::NamedTuple{(:varargs, :normalise),Tuple{Nothing,Bool}}, ::Type{Zygote.Adjoint}, ::IRTools.IR) at ./none:0
 [7] _lookup_grad(::Type) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/emit.jl:117
 [8] #s59#1241 at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:20 [inlined]
 [9] #s59#1241(::Any, ::Any, ::Any) at ./none:0
 [10] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any,N} where N) at ./boot.jl:524
 [11] #call#111 at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [12] (::typeof(∂(#call#111)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [13] #135 at /home/eric/.julia/packages/Zygote/fuj2C/src/lib/lib.jl:129 [inlined]
 [14] #238#back at /home/eric/.julia/packages/Zygote/fuj2C/src/lib/grad.jl:46 [inlined]
 [15] PyObject at /home/eric/.julia/packages/PyCall/ttONZ/src/pyfncall.jl:89 [inlined]
 [16] (::typeof(∂(λ)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [17] torch_symeig at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:29 [inlined]
 [18] (::typeof(∂(torch_symeig)))(::Array{Float64,1}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface2.jl:0
 [19] test_eigmin at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:34 [inlined]
 [20] (::getfield(Zygote, Symbol("##32#33")){typeof(∂(test_eigmin))})(::Float64) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:38
 [21] gradient(::Function, ::Array{Float64,2}) at /home/eric/.julia/packages/Zygote/fuj2C/src/compiler/interface.jl:47
 [22] top-level scope at show.jl:582
 [23] include at ./boot.jl:328 [inlined]
 [24] include_relative(::Module, ::String) at ./loading.jl:1094
 [25] include(::Module, ::String) at ./Base.jl:31
 [26] exec_options(::Base.JLOptions) at ./client.jl:295
 [27] _start() at ./client.jl:468
in expression starting at /home/eric/Attempt-diff-eigmin/Methods/PyTorch via PyCall.jl:42
```


## Version information


### Julia 1.1, with Zygote master

Version information:

```julia
julia> Pkg.status()
    Status `~/Attempt-diff-eigmin/ZygoteMaster/Project.toml`
  [ec485272] ArnoldiMethod v0.0.4
  [8f4d0f93] Conda v1.3.0
  [14197337] GenericLinearAlgebra v0.1.0
  [42fd0dbc] IterativeSolvers v0.8.1
  [0b1a1467] KrylovKit v0.3.4
  [438e738f] PyCall v1.91.2
  [e88e6eb3] Zygote v0.3.2 #master (https://github.com/FluxML/Zygote.jl.git)
  [700de1a5] ZygoteRules v0.1.0 #master (https://github.com/FluxML/ZygoteRules.jl)

julia> versioninfo()
Julia Version 1.1.1
Commit 55e36cc308 (2019-05-16 04:10 UTC)
Platform Info:
  OS: Linux (x86_64-pc-linux-gnu)
  CPU: Intel(R) Core(TM) i7-6700K CPU @ 4.00GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-6.0.1 (ORCJIT, skylake)
```


### Julia 1.2, with Zygote master

Version information:

```julia
julia> Pkg.status()
    Status `~/Attempt-diff-eigmin/ZygoteMaster/Project.toml`
  [ec485272] ArnoldiMethod v0.0.4
  [8f4d0f93] Conda v1.3.0
  [14197337] GenericLinearAlgebra v0.1.0
  [42fd0dbc] IterativeSolvers v0.8.1
  [0b1a1467] KrylovKit v0.3.4
  [438e738f] PyCall v1.91.2
  [e88e6eb3] Zygote v0.3.2 #master (https://github.com/FluxML/Zygote.jl.git)
  [700de1a5] ZygoteRules v0.1.0 #master (https://github.com/FluxML/ZygoteRules.jl)

julia> versioninfo()
Julia Version 1.2.0-rc2.0
Commit 9248bf7687 (2019-07-08 19:42 UTC)
Platform Info:
  OS: Linux (x86_64-pc-linux-gnu)
  CPU: Intel(R) Core(TM) i7-6700K CPU @ 4.00GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-6.0.1 (ORCJIT, skylake)
```


### Julia 1.3, with Zygote master

Version information:

```julia
julia> Pkg.status()
    Status `~/Attempt-diff-eigmin/ZygoteMaster/Project.toml`
  [ec485272] ArnoldiMethod v0.0.4
  [8f4d0f93] Conda v1.3.0
  [14197337] GenericLinearAlgebra v0.1.0
  [42fd0dbc] IterativeSolvers v0.8.1
  [0b1a1467] KrylovKit v0.3.4
  [438e738f] PyCall v1.91.2
  [e88e6eb3] Zygote v0.3.2 #master (https://github.com/FluxML/Zygote.jl.git)
  [700de1a5] ZygoteRules v0.1.0 #master (https://github.com/FluxML/ZygoteRules.jl)

julia> versioninfo()
Julia Version 1.3.0-alpha.0
Commit 6c11e7c2c4 (2019-07-23 01:46 UTC)
Platform Info:
  OS: Linux (x86_64-pc-linux-gnu)
  CPU: Intel(R) Core(TM) i7-6700K CPU @ 4.00GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-6.0.1 (ORCJIT, skylake)
```


### Julia 1.1, with Zygote release

Version information:

```julia
julia> Pkg.status()
    Status `~/Attempt-diff-eigmin/ZygoteRelease/Project.toml`
  [ec485272] ArnoldiMethod v0.0.4
  [8f4d0f93] Conda v1.3.0
  [14197337] GenericLinearAlgebra v0.1.0
  [42fd0dbc] IterativeSolvers v0.8.1
  [0b1a1467] KrylovKit v0.3.4
  [438e738f] PyCall v1.91.2
  [e88e6eb3] Zygote v0.3.2

julia> versioninfo()
Julia Version 1.1.1
Commit 55e36cc308 (2019-05-16 04:10 UTC)
Platform Info:
  OS: Linux (x86_64-pc-linux-gnu)
  CPU: Intel(R) Core(TM) i7-6700K CPU @ 4.00GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-6.0.1 (ORCJIT, skylake)
```


### Julia 1.2, with Zygote release

Version information:

```julia
julia> Pkg.status()
    Status `~/Attempt-diff-eigmin/ZygoteRelease/Project.toml`
  [ec485272] ArnoldiMethod v0.0.4
  [8f4d0f93] Conda v1.3.0
  [14197337] GenericLinearAlgebra v0.1.0
  [42fd0dbc] IterativeSolvers v0.8.1
  [0b1a1467] KrylovKit v0.3.4
  [438e738f] PyCall v1.91.2
  [e88e6eb3] Zygote v0.3.2

julia> versioninfo()
Julia Version 1.2.0-rc2.0
Commit 9248bf7687 (2019-07-08 19:42 UTC)
Platform Info:
  OS: Linux (x86_64-pc-linux-gnu)
  CPU: Intel(R) Core(TM) i7-6700K CPU @ 4.00GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-6.0.1 (ORCJIT, skylake)
```


### Julia 1.3, with Zygote release

Version information:

```julia
julia> Pkg.status()
    Status `~/Attempt-diff-eigmin/ZygoteRelease/Project.toml`
  [ec485272] ArnoldiMethod v0.0.4
  [8f4d0f93] Conda v1.3.0
  [14197337] GenericLinearAlgebra v0.1.0
  [42fd0dbc] IterativeSolvers v0.8.1
  [0b1a1467] KrylovKit v0.3.4
  [438e738f] PyCall v1.91.2
  [e88e6eb3] Zygote v0.3.2

julia> versioninfo()
Julia Version 1.3.0-alpha.0
Commit 6c11e7c2c4 (2019-07-23 01:46 UTC)
Platform Info:
  OS: Linux (x86_64-pc-linux-gnu)
  CPU: Intel(R) Core(TM) i7-6700K CPU @ 4.00GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-6.0.1 (ORCJIT, skylake)
```

